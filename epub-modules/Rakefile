module_name = 'epub_renderer'

# ------------------------------------------------------------------------------------------------------------------------
#  Generated by jasmine
# ------------------------------------------------------------------------------------------------------------------------

begin
  require 'jasmine'
  load 'jasmine/tasks/jasmine.rake'
rescue LoadError
  task :jasmine do
    abort "Jasmine is not available. In order to run jasmine, you must: (sudo) gem install jasmine"
  end
end

this_dir = File.dirname(__FILE__)
src_dir = "#{this_dir}"
out_dir = "#{this_dir}/min"
module_file_name = "#{module_name}_module"

task :default => [:gen_module]

require 'rake/clean'

CLEAN.include(out_dir)

directory out_dir

desc "generate #{module_name} module"
task :gen_module => ['clean', out_dir] do

  optimizer_file_path = "#{this_dir}/../build/r.js"
  sh "node #{optimizer_file_path} -o #{this_dir}/build.js name=#{module_file_name} baseUrl=#{src_dir} optimize=none"\
  " out=#{out_dir}/#{module_file_name}.min.js"

end